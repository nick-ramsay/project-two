SELECT (CASE WHEN DAYOFWEEK("2019-11-04") = 1 THEN TIME_FORMAT(TIMEDIFF(mechaniccentreordinaryhours.sun_end, mechaniccentreordinaryhours.sun_start), "%H")*2 + TIME_FORMAT(TIMEDIFF(mechaniccentreordinaryhours.sun_end, mechaniccentreordinaryhours.sun_start), "%i")/30 WHEN DAYOFWEEK("2019-11-04") = 2 THEN  TIME_FORMAT(TIMEDIFF(mechaniccentreordinaryhours.mon_end, mechaniccentreordinaryhours.mon_start), "%H")*2 + TIME_FORMAT(TIMEDIFF(mechaniccentreordinaryhours.mon_end, mechaniccentreordinaryhours.mon_start), "%i")/30 WHEN DAYOFWEEK("2019-11-04") = 3 THEN TIME_FORMAT(TIMEDIFF(mechaniccentreordinaryhours.tue_end, mechaniccentreordinaryhours.tue_start), "%H")*2 + TIME_FORMAT(TIMEDIFF(mechaniccentreordinaryhours.tue_end, mechaniccentreordinaryhours.tue_start), "%i")/30 WHEN DAYOFWEEK("2019-11-04") = 4 THEN TIME_FORMAT(TIMEDIFF(mechaniccentreordinaryhours.wed_end, mechaniccentreordinaryhours.wed_start), "%H")*2 + TIME_FORMAT(TIMEDIFF(mechaniccentreordinaryhours.wed_end, mechaniccentreordinaryhours.wed_start), "%i")/30 WHEN DAYOFWEEK("2019-11-04") = 5 THEN TIME_FORMAT(TIMEDIFF(mechaniccentreordinaryhours.thu_end, mechaniccentreordinaryhours.thu_start), "%H")*2 + TIME_FORMAT(TIMEDIFF(mechaniccentreordinaryhours.thu_end, mechaniccentreordinaryhours.thu_start), "%i")/30 WHEN DAYOFWEEK("2019-11-04") = 6 THEN TIME_FORMAT(TIMEDIFF(mechaniccentreordinaryhours.fri_end, mechaniccentreordinaryhours.fri_start), "%H")*2 + TIME_FORMAT(TIMEDIFF(mechaniccentreordinaryhours.fri_end, mechaniccentreordinaryhours.fri_start), "%i")/30 WHEN DAYOFWEEK("2019-11-04") = 7 THEN TIME_FORMAT(TIMEDIFF(mechaniccentreordinaryhours.sat_end, mechaniccentreordinaryhours.sat_start), "%H")*2 + TIME_FORMAT(TIMEDIFF(mechaniccentreordinaryhours.sat_end, mechaniccentreordinaryhours.sat_start), "%i")/30 ELSE "0" END) timeslots, /*automendo.appointments.**/ FROM automendo.mechaniccentreordinaryhours LEFT JOIN automendo.appointments on automendo.mechaniccentreordinaryhours.mechanic_centre_id = automendo.appointments.mechanic_centre_id WHERE automendo.mechaniccentreordinaryhours.mechanic_centre_id = 1 and automendo.appointments.appointment_date = "2019-11-04";